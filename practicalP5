import sys

class Graph:
    def __init__(self, vertices):
        # Number of vertices
        self.V = vertices
        # Represent graph as adjacency matrix (2D list)
        # Initialize all edge weights to 0
        self.graph = [[0 for _ in range(vertices)] for _ in range(vertices)]

    # Function to add an undirected edge with weight w
    def addEdge(self, u, v, w):
        self.graph[u][v] = w
        self.graph[v][u] = w  # Since the graph is undirected

    # Function to print the MST stored in parent[]
    def printMST(self, parent):
        print("Edges in the constructed MST:")
        total_weight = 0
        # Start from 1 because parent[0] = -1 (root)
        for i in range(1, self.V):
            print(parent[i], "--", i, "==", self.graph[i][parent[i]])
            total_weight += self.graph[i][parent[i]]
        print("Minimum Spanning Tree Weight:", total_weight)

    # Function that implements Prim's Algorithm
    def primMST(self):
        # Key values to pick minimum weight edge for each vertex
        key = [sys.maxsize] * self.V

        # Array to store constructed MST
        parent = [-1] * self.V

        # Boolean array to mark vertices included in MST
        mstSet = [False] * self.V

        # Start from the first vertex (index 0)
        key[0] = 0

        # The MST will have V vertices
        for _ in range(self.V):
            # Find the vertex with the minimum key value
            min_key = sys.maxsize
            u = -1
            for v in range(self.V):
                if not mstSet[v] and key[v] < min_key:
                    min_key = key[v]
                    u = v

            # Add the chosen vertex to the MST set
            mstSet[u] = True

            # Update key and parent index for adjacent vertices
            for v in range(self.V):
                # graph[u][v] is non-zero only for adjacent vertices
                # mstSet[v] is False for vertices not yet included
                # Update the key only if graph[u][v] < current key[v]
                if self.graph[u][v] and not mstSet[v] and self.graph[u][v] < key[v]:
                    key[v] = self.graph[u][v]
                    parent[v] = u

        # Print the final MST
        self.printMST(parent)


# Driver code
if __name__ == "__main__":
    # Create a graph with 5 vertices
    g = Graph(5)

    # Add edges (u, v, weight)
    g.addEdge(0, 1, 2)
    g.addEdge(0, 3, 6)
    g.addEdge(1, 2, 3)
    g.addEdge(1, 3, 8)
    g.addEdge(1, 4, 5)
    g.addEdge(2, 4, 7)
    g.addEdge(3, 4, 9)

    # Run Prim's Algorithm
    g.primMST()
